<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document Requests - UPM</title>
  <link rel="stylesheet" href="/css/globals.css" />
  <link rel="stylesheet" href="/css/spending.css" />
  </head>
  <body>
    <div class="container">
      <header class="header">
        <div class="header-left">
          <div class="logo">
            <img src="assets/logo.svg" alt="UPM Logo" />
            <span>UPM</span>
          </div>
        </div>
        <nav class="nav" id="nav">
          <a href="/admin" class="nav-link">User Approvals</a>
          <a href="/admin/applications" class="nav-link">Applications</a>
          <a href="/admin/documents" class="nav-link active">Documents</a>
        </nav>
        <div class="header-right">
          <img src="assets/header-end-icon.svg" alt="Header Icon" />
        </div>
      </header>
      <main class="main-content">
        <div class="page-header">
          <h1 class="page-title">Document <span>Requests</span></h1>
        </div>
        <div class="table-section">
          <h2 class="table-title">DOCUMENT REQUESTS</h2>
          <div class="table-container">
            <table class="spending-table">
              <thead>
                <tr>
                  <th>Ping ID</th>
                  <th>Type</th>
                  <th>File</th>
                  <th>Source</th>
                  <th>Created At</th>
                  <th>Status</th>
                  <th>Actions</th>
                </tr>
              </thead>
              <tbody>
                <% if (documents && documents.length > 0) { %>
                  <% documents.forEach(function(doc) { %>
                    <tr>
                      <td><%= doc.pingId %></td>
                      <td><%= doc.docType %></td>
                      <td><a href="/uploads/<%= doc.filePath %>" target="_blank">View</a></td>
                      <td><%= doc.source %></td>
                      <td><%= doc.createdAt ? doc.createdAt.toISOString().slice(0,10) : '' %></td>
                      <td><%= doc.status %></td>
                      <td>
                        <% if (doc.status === 'pending') { %>
                          <form action="/admin/documents/<%= doc._id %>/approve" method="POST" style="display:inline;">
                            <button type="submit">Approve</button>
                          </form>
                          <form action="/admin/documents/<%= doc._id %>/reject" method="POST" style="display:inline;">
                            <button type="submit">Reject</button>
                          </form>
                        <% } else { %>
                          <span style="color:#888;">-</span>
                        <% } %>
                      </td>
                    </tr>
                  <% }) %>
                <% } else { %>
                  <tr>
                    <td colspan="6" style="text-align:center; color:#888;">No document requests found.</td>
                  </tr>
                <% } %>
              </tbody>
            </table>
          </div>
        </div>
      </main>
    </div>
  </body>
</html>
